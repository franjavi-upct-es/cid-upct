\input{../../../Macros.tex}
\title{Álgebra Lineal\\Ejercicios Tema 6}

\begin{document}
\maketitle
\begin{enumerate}[label=\color{red}\textbf{\arabic*)}]
    \item \lb{Halla ma matriz real más general posible que tiene como vectores propios los vectores $(1,1)$ y $(1,-2)$} 

        Si $A$ tiene dos vectores propios distintos, admite la factorización e nvalores propios siguiente:  \[
        A=P^{-1}DP,
        \]con \[
        \begin{array}{l}
            P=\begin{bmatrix} 
                1 & 1 \\ 1 & -1 
            \end{bmatrix} \\
            D=\begin{bmatrix} 
                \lambda_1 & 0\\ 0 & \lambda_2 
            \end{bmatrix} ,\quad \lambda_1,\lambda_2\in \R\\
            P^{-1}=\begin{bmatrix} 
                1 & 1\\ 1  & -1
            \end{bmatrix} 
        \end{array}
        \]  
        Por tanto, \[
        A=\begin{bmatrix} 
            1 & 1\\ 1 & -1 
        \end{bmatrix} \begin{bmatrix} 
            \lambda_1 & \lambda_1\\
            \lambda_2 & \lambda_2
        \end{bmatrix} =\begin{bmatrix} 
            \lambda_1+\lambda_2 & \lambda_1-\lambda_2\\
            \lambda_1-\lambda_2 & \lambda_1+\lambda_2
        \end{bmatrix} 
        \] 
    \item \lb{Dada la matriz $\begin{bmatrix} 
                a & 0\\ b & a 
    \end{bmatrix} $ con $b\neq 0$, explica por qué no existe ninguna matriz invertible $P$ tal que la matriz $P^{-1}AP$ sea una matriz diagonal. ¿Puedes generalizar este resultado para matrices de mayor tamaño?}

    \[
    A=\begin{bmatrix} 
        a & 0\\ b & a 
    \end{bmatrix} \quad b\neq 0.
    \] 
    Valores propios $\lambda = a$ doble

    \[
    \mathrm{nuc}(A-\lambda I)=\begin{bmatrix} 
        0 & 0\\
        b & 0
    \end{bmatrix}\begin{bmatrix} 
    x\\y 
    \end{bmatrix}  =\begin{bmatrix} 
    0\\0 
    \end{bmatrix} \longrightarrow bx=0\longrightarrow x=0\longrightarrow v=(0,1)
    \] 
    Sólo hay un vector propio, por lo que la matriz no se puede factoriza ne valores propios.
    \item \lb{Sea $A$ una matriz diagonalizable con valores propios $\lambda_1,\dots,\lambda_n$. Prueba que la matriz $A^2$ también es diagonalizable con valores propios $\lambda_1^2,\dots,\lambda_n^2$.}

        $Av_j=\lambda_jv_j$

        $\forall v_j=A\lambda_jv_j=\lambda_jAv_j=\lambda_j^2v_j.$
    \item \lb{Sea $A$ una matriz invertible y sean  $\lambda_1,\dots,\lambda_n$ los autovalores de $A$. ¿Cuáles son los autovalores de $A^{-1}$?}

        $Av_j=\lambda_jv_j$

        $v_{j}=A^{-1}Av_j=\lambda_jA^{-1}v_j\longrightarrow A^{-1}v_j=\dfrac{1}{\lambda_j}v_j$
    \item \lb{Determina los valores de $a$ para los cuales la matriz  $\begin{bmatrix} 
                5 & -3 & a \\ 6 & -4 & 6\\
                0 & 0 & 2
    \end{bmatrix} $ es diagonalizable.}

    $P_{\lambda}(A)=\mathrm{det}(A-\lambda I)=\mathrm{det}\begin{bmatrix} 
        5-\lambda & -3 & a\\
        6 & -4-\lambda & 6\\
        0 & 0 & 2-\lambda
    \end{bmatrix}=(2-\lambda)\mathrm{det}=(2-\lambda)(-(4+\lambda)(5-\lambda)+18) $

    $-(4+\lambda)(5-\lambda)+18=-(20-4\lambda+5\lambda -\lambda^2)+18=-20-\lambda+\lambda^2+18=\lambda^2-\lambda-2=0$ \[
    \lambda=\dfrac{1\pm\sqrt{(-1)^2-4\cdot 1\cdot (-2)} }{2\cdot 1}=\dfrac{1\pm\sqrt{1+8} }{2}=\begin{cases}
        \dfrac{1+3}{2}=\dfrac{4}{2}=2\\
        \dfrac{1-3}{2}=-\dfrac{2}{2}=-1
    \end{cases} 
    \] 
    \underline{Valores propios}
\begin{itemize}[label=\textbullet]
    \item $\lambda_1=2$ multiplicidad 2
    \item $\lambda_2=-1$ multiplicidad 2
\end{itemize}
$\mathrm{det}(A-2I)=\begin{bmatrix} 
    3 & -3 & a\\
    6 & -6 & 6\\
    0 & 0 & 0
\end{bmatrix}\begin{bmatrix} 
x\\y\\z 
\end{bmatrix}=\begin{bmatrix} 
0\\0\\0 
\end{bmatrix}\longrightarrow \begin{cases}
    3x-3y+az=0\\
    6x-6y+6z=0
\end{cases}\longrightarrow \begin{vmatrix} 
    3 & a\\
    6  & 
\end{vmatrix}=18-6a=0\longleftrightarrow a=3$

Si $a=3\longrightarrow \mathrm{rango}(A-2I)=1$, es decir:
\begin{itemize}[label=\textbullet]
    \item Dos parámetros
    \item Dos vectores propios
    \item $A$ es diagonalizable porque tendríamos una base de vectores propios: dos correspondientes al valor propio $\lambda_1=2$ y otro correspondiente a $\lambda_2=-1$.
\end{itemize}
Si $a\neq 3$ sólo habría un vector propio para $\lambda_1=2$ y la matriz no sería diagonalizable.
\item \lb{Una expresa comercializa dos marcas de un producto. Entre los usuarios de estas marcas la empresa ha posido determinar que la probabilidad de que un usuario de la marca 1 se pase a la marca 2 después de un mes es de 0.4, y la probbilidad de que un usuario de la marca 2 se pase a la marca 1 después de un mes es de 0.2. Con esta información, obsera que la matriz \[
A= \begin{bmatrix} 
    0.6 & 0.2\\ 0.4 & 0.8 
\end{bmatrix} 
\]es tal que $a_{ij}$ es la probabilidad de que un usuario de la marca $j$ se pase a la marca $j$ después de un mes. Este tipo de matrices se llaman \textbf{matrices de Markov}.\newline 
Si inicialmente  hay, por ejemplo, un 20\% de usuarios que prefieren la marca 1 y un 80\% que prefieren la 2, se puede ver, usando argumentos probabilísticos, que las preferencias de los usuarios después de $n$ meses vienen dadas por \[
A^n\begin{bmatrix} 
0.2\\0.8 
\end{bmatrix} 
\] Determina cuáles será las preferencias por cada marca en el futuro} 

Idea: Calculamos los valores y vectores propios de $A$ y obtenemos la factorizaión \[
A=P^{-1}DP.
\] 
Por tanto, $A^n=P^{-1}DP\cdot P^{-1}DP\cdots P^{-1}DP=P^{-1}D^nP$.
\item \lb{\textbf{El secreto de Google y el Álgebra Lineal.} El teorema que sigue es una pieza clave en el algoritmo \textit{PageRank} que usa (o usaba) \textit{Google} para ordenar las búsquedas de las páginas de Internet. En su versión más sencilla, el Teorema de Perron-Frobenius se enuncia así: Sea A una matrix cuadrada con entradas positivas, es decir, $a_{ij} > 0$. Entonces existe un autovalor simple (es decir, de multiplicidad 1) cuyo autovector asociado puede elegirse con todas sus componentes estrictamente positivas. Calcula los autovalores y autovectores de la matriz \[A=\begin{bmatrix}1 & 3 & 4\\3 & 1 & 1\\1 & 3 & 2\end{bmatrix}\]y comprueba que se satisface el Teorema de Perron-Frobenius. Se recomienda la lectura del artículo \linebreak \textbf{\texttt{https://sctmates.webs.ull.es/modulo1lp/8/pfernandez.pdf}} a aquellos alumnos que tengan curiosidad por saber las Matemáticas usadas en el algoritmo \textit{PageRank} de Google. En particular, se podrá apreciar el papel destacado del Teorema de Perron-Frobenius.}

\item \lb{Calcula y compara los valores propios y los valores singulares de las matrices \[
A=\begin{bmatrix} 
    0 & 1 & 0 & 0\\
    0 & 0 & 2 & 0\\
    0 & 0 & 0 & 3\\
    0 & 0 & 0 & 0
\end{bmatrix} \qquad B=\begin{bmatrix} 
    0 & 1 & 0 & 0\\
    0 & 0 & 2 & 0\\
    0 & 0 & 0 & 3\\
    \frac{1}{60000} & 0 & 0 & 0 
\end{bmatrix} 
\]¿Qué conclusión puedes sacar?}

Valores propios: \[
\mathrm{det}(A-\lambda I)=\mathrm{det}\begin{bmatrix} 
    -\lambda & 1 & 0 & 0\\
    0 & -\lambda & 2 & 0\\
    0 & 0 & -\lambda & 3\\
    0 & 0 & 0 & -\lambda
\end{bmatrix} =(-\lambda)^4=0
\] 
$\lambda=0$ multiplicidad 4

\[
A^\intercal A=\begin{bmatrix} 
    0 & 0 & 0 & 0\\
    1 & 0 & 0 & 0\\
    0 & 2 & 0 & 0\\
    0 & 0 & 3 & 0
\end{bmatrix} \begin{bmatrix} 
    0 & 1 & 0 & 0\\
    0 & 0 & 2 & 0\\
    0 & 0 & 0 & 3\\
    0 & 0 & 0 & 0
\end{bmatrix} =\begin{bmatrix} 
    0 & 0 & 0 & 0\\
    0 & 1 & 0 & 0\\
    0 & 0 & 4 & 0\\
    0 & 0 & 0 & 9
\end{bmatrix} 
\] 
$P_\lambda(A^\intercal A)=\mathrm{det}(A^\intercal A-\lambda I)=0\longrightarrow \sigma_1=3,\sigma_2=2,\sigma_3=1,\sigma_4=0$ 

$P_B(\lambda)=\mathrm{det}\begin{bmatrix} 
    -\lambda & 1 & 0 & 0\\
    0 & -\lambda & 2 & 0\\
    0 & 0 & -\lambda & 3\\
    \frac{1}{60000} & 0 & 0 & -\lambda 
\end{bmatrix}=-\lambda\begin{vmatrix} 
    -\lambda & 2 & 0\\
    0 & -\lambda & 3\\
    0 & 0 & -\lambda
\end{vmatrix}-\begin{bmatrix} 
    0 & 2 & 0\\
    0 & -\lambda & 3\\
    \frac{1}{60000} & 0 & -\lambda 
\end{bmatrix} =(-\lambda)^4-\left( \dfrac{6}{60000} \right)=0\longrightarrow \lambda^4=10^{-4}\begin{cases}
    \lambda_1=0.1\text{ multiplicidad 2 }\\
    \lambda_2=0.1j\text{ multiplicidad 2 }\\
\end{cases}  $ 

\underline{Valores singulares} \[
\sigma_1=3,\quad\sigma_2=2,\quad\sigma_3=1,\quad\sigma_4=0
\]  
\[
B^\intercal B=\begin{bmatrix} 
    0 & 0 & 0 & \frac{1}{60000}\\
    1 & 0 & 0 & 0\\
    0 & 2 & 0 & 0\\
    0 & 0 & 3 & 0
\end{bmatrix}\begin{bmatrix} 
    0 & 1 & 0 & 0\\ 
    0 & 0 & 2 & 0\\
    0 & 0 & 0 & 3\\
    \frac{1}{60000} & 0 & 0 & 0 
\end{bmatrix}=\begin{bmatrix} 
    2.7\cdot 10^{-10} & 0 & 0 & 0\\
    0 & 1 & 0 & 0\\
    0 & 0 & 4 & 0\\
    0 & 0 & 0 & 9
\end{bmatrix} 
\] 
\underline{Conclusión:} Pequeños cambios en los datos pueden afectar mucho a los autovalores, pero no tanto a los valores singulares. 
\item \lb{Consideremos la matriz $A=\begin{bmatrix} 
            3 & 8\\
            0 & 3
\end{bmatrix} $} 
\begin{enumerate}[label=\color{red}\textbf{\alph*)}]
    \item \db{Calcula los valores propios y los valores singulares de $A$.}

        $P_A(\lambda)=\mathrm{det}(A-\lambda I)=\mathrm{det}\begin{bmatrix} 
            3-\lambda & 8\\
            0 & 3-\lambda
        \end{bmatrix}=(3-\lambda)^2=0 $

        $\lambda=3$ multiplicidad 2.

        $\mathrm{nuc}(A-3I)=\begin{bmatrix} 
            0 & 8\\
            0 & 0
        \end{bmatrix}\begin{bmatrix} 
        x\\y 
        \end{bmatrix}=\begin{bmatrix} 
        0\\0 
        \end{bmatrix}\longrightarrow 8y=0\longrightarrow y=0\longrightarrow \text{vector propio }v_1=(1,0) $
    \item \db{¿Es A diagonalizable?}

        No se puede conseguir una base de vectores propios. Por tanto, $A$ no diagonalizable.
    \item \db{Calcula las matrices $U$ y $V$ ortogonales tales que $A=U\Sigma V^\intercal$, donde $\Sigma=\begin{bmatrix} 
                \sigma_1 & 0\\
                0 & \sigma_2
    \end{bmatrix} $ con $\sigma_1,\sigma_2$ los valores singulares de $A$.}

    $A^\intercal A=\begin{bmatrix} 
        3 & 0\\
        8 & 3
    \end{bmatrix}\begin{bmatrix} 
        3 & 8\\
        0 & 3
    \end{bmatrix}=\begin{bmatrix} 
        9 & 24\\
        24 & 73
    \end{bmatrix}$ 

    $P_{A^\intercal A}(\lambda)=\mathrm{det}(A^\intercal A-\lambda I)=\mathrm{det}\begin{bmatrix} 
        9-\lambda & 24\\
        24 & 73-\lambda
    \end{bmatrix}=(9-\lambda)(73-\lambda)-24\cdot 24=657-9\lambda-73\lambda-576+\lambda^2)\lambda^2-82\lambda+81=0$
    \[
    \lambda=\dfrac{82\pm\sqrt{(-82)^2-4\cdot 1\cdot 81} }{2\cdot 1}=\dfrac{82\pm\sqrt{6724-324} }{2}=\begin{cases}
        \dfrac{82+80}{2}=81=\lambda_1\\
        \dfrac{821-80}{2}=1=\lambda_2
    \end{cases}
    \] 
    Valores singulares: \[
    \begin{array}{l}
        \sigma_1=\sqrt{81}=9\\
        \sigma_2=\sqrt{1}=1 
    \end{array}\qquad\Sigma=\begin{bmatrix} 
    9 & 0\\0 & 1 
    \end{bmatrix} 
    \] 
    Vectores propios de $A^\intercal A$:
    \begin{itemize}[label=\textbullet]
        \item $\lambda_1=81$

            \[
            \mathrm{nuc}(A^\intercal A-81I)=\begin{bmatrix} 
                -72 & 24\\
                24 & -8
            \end{bmatrix}\begin{bmatrix} 
            x\\y 
            \end{bmatrix}  =\begin{bmatrix} 
            0\\0 
            \end{bmatrix} \longrightarrow \begin{cases}
                -72x+24y=0\\
                24x-8y=0
            \end{cases}\longrightarrow 8y=24x\longrightarrow y=3x\longrightarrow (1,3)
            \] 
            $v_1=\dfrac{1}{\|v_1\|}(1,3)=\dfrac{1}{\sqrt{10} }(1,3)$
        \item $\lambda_2=1$

            \[
            \mathrm{nuc}(A^\intercal A-I)=\begin{bmatrix} 
                8 & 24\\
                24 & 72
            \end{bmatrix} \begin{bmatrix} 
            x\\ y 
            \end{bmatrix} =\begin{bmatrix} 
            0\\0 
            \end{bmatrix} \longrightarrow \begin{cases}
                8x+24y=0\\
                24x+72y=0
            \end{cases}\longrightarrow x=-3y\longrightarrow (-3,1)
            \] 
            $v_2=\dfrac{1}{\|v_2\|}(-3,1)=\dfrac{1}{\sqrt{10} }(-3,1)$
    \end{itemize}   
    \[
    V=\dfrac{1}{\sqrt{10} }\begin{bmatrix} 
        1 & -3\\
        3 & 1
    \end{bmatrix} 
    \]

    $\begin{array}{l}
        u_1=\dfrac{1}{\sigma_1}Av_1=\dfrac{1}{9}\begin{bmatrix} 
            3 & 8\\
            0 & 3
        \end{bmatrix} \dfrac{1}{\sqrt{10} }\begin{bmatrix} 
        1\\3 
        \end{bmatrix} =\dfrac{1}{9\sqrt{10} }\begin{bmatrix} 
        27\\ 9 
        \end{bmatrix} =\dfrac{1}{\sqrt{10} }\begin{bmatrix} 
        3\\1 
        \end{bmatrix} \\
        u_2=\dfrac{1}{\sigma_2}Av_2=\begin{bmatrix} 
            3 & 8\\
            0 & 3
        \end{bmatrix} \dfrac{1}{\sqrt{10} }\begin{bmatrix} 
        -3\\1 
        \end{bmatrix} =\dfrac{1}{\sqrt{10} }\begin{bmatrix} 
        -1\\3 
        \end{bmatrix} 
    \end{array}$ 
    \[
    U=\dfrac{1}{\sqrt{10} }\begin{bmatrix} 
        3 & -3\\
        1 & 1
    \end{bmatrix} 
    \] 
\end{enumerate}
\item \lb{Encuentra la factorización SVD de las matrices \[
\begin{bmatrix} 
    0 & 0 \\ 0 & 3\\-2 & 0 
\end{bmatrix}\qquad \begin{bmatrix} 
    2 & 0 & 1\\
    0 & 2 & 0
\end{bmatrix} 
\]Para la primera de ellas, escribe la matriz como una suma de matrices de rango 1, según se explica en la página 121 de los apuntes.}

\[
A^\intercal A=\begin{bmatrix} 
    0 & 0 & -2\\
    0 & 3 & 0
\end{bmatrix}\begin{bmatrix} 
    0 & 0\\ 0 & 3\\ -2 & 0 
\end{bmatrix}  =\begin{bmatrix} 
    4 & 0 \\
    0 & 9
\end{bmatrix} 
\] 
$P_{A^\intercal A}(\lambda)=\mathrm{det}(A^\intercal A-\lambda I)=\mathrm{det}\begin{bmatrix} 
    4-\lambda & 0\\
    0 & 9-\lambda
\end{bmatrix}=(4-\lambda)(9-\lambda)=0 $

$\begin{array}{l}
    \lambda_1=9\longrightarrow \sigma_1=\sqrt{9} =3\\
    \lambda_2=4\longrightarrow \sigma_2=\sqrt{4} =2
\end{array}$ 
\begin{itemize}[label=\textbullet]
    \item $\lambda_1=9$

        $\mathrm{nuc}(A^\intercal A-9I)\longrightarrow \begin{bmatrix} 
            -5 & 0\\
            0 & 0
        \end{bmatrix}\begin{bmatrix} 
        x\\ y 
        \end{bmatrix}=\begin{bmatrix} 
        0\\ 0 
        \end{bmatrix}\longrightarrow -5x=0\longrightarrow x=0\longrightarrow y=1\longrightarrow v_1=(0,1)$

    \item $\lambda_2=4$

        $\mathrm{nuc}(A^\intercal A-4I)=\begin{bmatrix} 
            0 & 0\\
            0 & 5
        \end{bmatrix}\begin{bmatrix} 
        x\\y 
        \end{bmatrix}=\begin{bmatrix} 
        0\\0 
        \end{bmatrix}\longrightarrow 5y=0\longrightarrow y=0\longrightarrow x=1\longrightarrow v_2=(1,0)   $
\end{itemize}
\[
V=\begin{bmatrix} 
    0 & 1\\
    1 & 0
\end{bmatrix}\longrightarrow V^\intercal=\begin{bmatrix} 
    0 & 1\\
    1 & 0
\end{bmatrix}  
\] 
Cálculo de $U$:  \[
\begin{array}{l}
    u_1=\dfrac{1}{\sigma_1}Av_1=\dfrac{1}{3}\begin{bmatrix} 
        0 & 0\\
        0 & 3\\
        -2 & 0
    \end{bmatrix} \begin{bmatrix} 
    0\\1 
    \end{bmatrix} =\dfrac{1}{3}\begin{bmatrix} 
    0\\3\\0 
    \end{bmatrix} =\begin{bmatrix} 
    0\\1\\0 
    \end{bmatrix} \\
    u_2=\dfrac{1}{\sigma_2}Av_2=\dfrac{1}{2}\begin{bmatrix} 
        0 & 0\\0 & 3\\-2 & 0 
    \end{bmatrix} \begin{bmatrix} 
    1\\0 
    \end{bmatrix} =\dfrac{1}{2}\begin{bmatrix} 
    0\\0\\-2 
    \end{bmatrix} =\begin{bmatrix} 
    0\\0\\-1 
    \end{bmatrix} 
\end{array}
\] 
Completamos $u_1=(0,1,0),u_2=(0,0,-1)$ a una base ortonormal de $\R^3$. Basta tomar: \[
u_3=(1,0,0)
\] 
Por tanto: \[
U=\begin{bmatrix} 
    0 & 0 & 1\\
    1 & 0 & 0\\
    0 & -1 & 0\\
\end{bmatrix}
\] 
En resumen \[
B^\intercal=\lbb{\begin{bmatrix} 
        \frac{2}{\sqrt{5} } & 0 & -\frac{1}{\sqrt{5} } \\
        0 & 1 & 0\\
        \frac{1}{\sqrt{5} } & 0 & \frac{2}{\sqrt{5} } 
\end{bmatrix} }{U} \cdot\lbb{\begin{bmatrix} 
        \sqrt{5} & 0\\
        0 & 2\\
        0 & 0
\end{bmatrix} }{\Sigma}\cdot\lbb{\begin{bmatrix} 
        0 & 1\\ 1 & 0 
\end{bmatrix} }{V^\intercal}  
\] 
Tomando la traspuesta: \[
B=V\Sigma^\intercal U^\intercal=\begin{bmatrix} 
    1 & 0\\0 & 1 
\end{bmatrix} \begin{bmatrix} 
    \sqrt{5} & 0 & 0\\
    0 & 2 & 0
\end{bmatrix}\begin{bmatrix} 
        \frac{2}{\sqrt{5} } & 0 & \frac{1}{\sqrt{5} } \\
        0 & 1 & 0\\
       -\frac{1}{\sqrt{5} } & 0 & \frac{2}{\sqrt{5} } 
\end{bmatrix}  
\] 
\item \lb{Sea $A$ uan matriz real y simétrica. Prueba que los valores singulares de  $A$ son los valores absolutos de los valores propios de $A$. ¿Qué pasa si $A$ es semidefinida positiva?} 

    A simétrica $\longrightarrow A^\intercal=A$. Los valores propios de $A^\intercal A$ son los valores propios de $A^2$.

    Por el ejercicio 4, los valores propios de $A^2$ son $\lambda_i^2$ con $\lambda_i$ los valores propios de  $A$.

    Por tanto,  $\sigma_i=\sqrt{\lambda_i^2}=|\lambda_i| $.

    Si $A$ es semidefinida positiva, $\lambda_i\ge 0$. Por tanto: \[
    \sigma_i=\sqrt{\lambda_i^2}=\lambda_i. 
    \] 
\end{enumerate}
\end{document}
