\input{../../../Macros.tex}
\title{Señales y Sistemas\\Examen Mayo 2025}

\usetikzlibrary{shapes,arrows}

\pgfmathdeclarefunction{delta}{1}{%
    \pgfmathparse{abs(#1) < 0.001 ? 1 : 0}%
}

% definir la función rectangular
\pgfmathdeclarefunction{rect}{1}{%
    \pgfmathparse{abs(#1) <= 0.5 ? 1 : 0}%
}

% definir el pulso triangular
\pgfmathdeclarefunction{tri}{1}{%
    \pgfmathparse{abs(#1) <= 1 ? (1 - abs(#1)) : 0}%
}

% definir la función escalón unitario
\pgfmathdeclarefunction{u}{1}{%
    \pgfmathparse{#1 >= 0 ? 1 : 0}%
}

\begin{document}
\maketitle
\rc{\textbf{\underline{Problema 1} } }\lb{Dominio del tiempo.}

\lb{Sea un sistema LTI continuo cuya respuesta al impulso es $h(t)=u(t)+\delta(t-6)$.}

\begin{enumerate}[label=\color{red}\textbf{\alph*)}]
	\item \db{Represente $h(t)$ y $h(2t-2)$.}

	      \begin{center}
              \begin{tikzpicture}[declare function={
                      h(\t)=u(\t)+delta(\t-6);
                  }]
			      \begin{axis}[
					      xmin= -2, xmax= 8,
					      ymin= -0.5, ymax = 1.5,
					      xlabel={$t$}, ylabel={$h(t)$},
					      axis lines = middle,
					      xlabel style={at={(axis cs:8,0)}, anchor=west},
					      ylabel style={at={(axis cs:0,1.5)}, anchor=south},
				      ]
				      \addplot[domain=-2:8, samples=1000, lightblue, line width=1.5] {h(x)};
			      \end{axis}
		      \end{tikzpicture}\qquad
              \begin{tikzpicture}[declare function={
                      h(\t)=u(\t)+delta(\t-6);
                  }]
                  \begin{axis}[
                      xmin= -2, xmax= 8,
                      ymin= -0.5, ymax = 1.5,
                      xlabel={$t$}, ylabel={$h(2t-2)$},
                      axis lines = middle,
                      xlabel style={at={(axis cs:8,0)}, anchor=west},
                      ylabel style={at={(axis cs:0,1.5)}, anchor=south},
                  ]
                      \addplot[domain=-2:8, samples=1000, lightblue, line width=1.5] {h(2*x-2)};
                  \end{axis}
              \end{tikzpicture}
	      \end{center}

	\item \db{Estuda las propiedades de memoria, causalidad y estabilidad del sistema.}

        $\begin{array}{l}
            h(t)\neq 0\text{ para }t\neq 0\longrightarrow \text{ con memoria }\\
            h(t)= 0\text{ para }t<0\longrightarrow \text{ causal }\\
            \int_{0}^{\infty} |h(t)|\dt=\infty\longrightarrow \text{}u
        \end{array}$
	\item \db{Calcule la señal de salida cuando a la entrada se aplica la señal $x(t)=e^{-t}u(t) $.}

        La salida es: \[
            y(t)=x(t)\ast h(t)=x(t)\ast [u(t)+\delta(t-6)]=x(t)\ast u(t)+x(t)\ast \delta(t-6)
        \] 
        \begin{enumerate}[label=\arabic*)]
            \item $x(t)\ast u(t)=\int_{0}^{t} e^{-\tau}\mathrm{d}\tau=1-e^{-t}$
            \item $x(t)\ast \delta(t-6)=x(t-6)=e^{-(t-6)}u(t-6) $
        \end{enumerate}
        Resultado final: \[
        y(t)=(1-e^{-t} )+e^{-(t-6)}u(t-6) 
        \] 
	\item \db{Calcule la energía total y potencia media de la señal de entrada $x(t)$.}

        \[
        \begin{array}{c}
           E=\int_{-\infty}^{\infty} |x(t)|^2\dt=\int_{0}^{\infty} e^{-2t}\dt=\left[ -\dfrac{1}{2}e^{-2t}  \right]_0^\infty=\left( \tozero{-\dfrac{e^{-\infty} }{2}} -\left( -\dfrac{e^{0} }{2} \right)  \right) =\dfrac{1}{2}\\
           P=\lim_{T \to \infty} \dfrac{1}{2T}\int_{-T}^{T}|x(t)|^2\dt=\lim_{T \to \infty} \dfrac{E}{2T}=\dfrac{\frac{1}{2} }{\infty}=0
        \end{array}
        \] 
	\item \db{Si la señal de entrada es $3e^{-(t-1)}u(t-1)+2e^{-(t-3)}u(t-3)  $, ¿cuál será la señal de salida?}

        Usamos la linealidad de la convolución: \[
        y(t)=3e^{-(t-1)}u(t-1)\ast h(t)+2e^{-(t-3)}u(t-3)\ast h(t)  
        \] 
        Sabemos que: \[
        e^{-(t-a)}u(t-a)\ast h(t)=(1-e^{-(t-a)} )u(t-a)+e^{-(t-a-6)} u(t-a-6)
        \] 
        Entonces:
        \begin{itemize}[label=\textbullet]
            \item Para el primer término ($a=1$): \[
            3\left[ (1-e^{-(t-1)} )u(t-1)+e^{-(t-7)}u(t-7)  \right] 
            \] 
            \item Para el segundo término $(a=3)$:  \[
            2\left[ (1-e^{-(t-3)} )u(t-3)+e^{-(t-9)}u(t-9)  \right] 
            \] 
        \end{itemize}
        Resultado final: \[
        y(t)=3(1-e^{-(t-1)} )u(t-1)+3e^{-(t-7)} u(t-7)+2(1-e^{-(t-3)} )u(t-3)+2e^{-(t-9)}u(t-9) 
        \] 
\end{enumerate}
\lb{Sea el sistema LTI discreto dado por la relación salida-entrada \[
	y[n]=\dfrac{1}{2}y[n-1]+x[n]+x[n-1]
\] }
\begin{enumerate}[label=\color{red}\textbf{\alph*)}, start=6]
	\item \db{Obtenga y represente la respuesta al impulso $h[n]$.}

        La respuesta al impulso se obtiene aplicando como entrada: \[
            x[n]=\delta[n]
        \] 
        Y calculando la salida $y[n]=h[n]$ paso a paso.

        $\begin{array}{l}
            n=0\longrightarrow \tozero{\dfrac{1}{2}y[-1]}+x[0]+\tozero{x[-1]}=1\\
            n=1\longrightarrow \dfrac{1}{2}y[0]+\tozero{x[1]}+x[0]=\dfrac{1}{2}\cdot 1+1=\dfrac{3}{2}\\
            n=2\longrightarrow \dfrac{1}{2}y[1]+\tozero{x[2]}+\tozero{x[1]}=\dfrac{1}{2}\cdot \dfrac{3}{2}=\dfrac{3}{4}\\
            n=3\longrightarrow \dfrac{1}{2}y[2]+\tozero{x[3]}+\tozero{x[2]}=\dfrac{1}{2}\cdot \dfrac{3}{4}=\dfrac{3}{8}\\
            n=4\longrightarrow \dfrac{1}{2}y[3]+\tozero{x[4]}+\tozero{x[3]}=\dfrac{1}{2}\cdot \dfrac{3}{8}=\dfrac{3}{16}\\
            \vdots
        \end{array}$

        Es un sistema IIR, ya que tiene retroalimentación.
	\item \db{Dibuje el diagrama de bloques del sistema en su forma directa I.}
        \begin{center}
            \begin{tikzpicture}[ >=latex,
                	block/.style={draw, minimum width=1cm, minimum height=1cm},
                	sum/.style={draw, circle, minimum size=5mm, inner sep=0pt},
                	connector/.style={-Latex, thick},
                	node distance=1.5cm and 1.5cm,
                	]
                    \node (x) at (0,0) {$x[n]$};
                    \node [block] (delay1) at (2, -2) {\small $z^{-1}$};
                    \node [sum] (sum1) at (4, 0) {$+$};
                    \node (y) at (10,0) {$y[n]$};
                    \node [block] (delay2) at (8,-2) {\small $z^{-1}$};
                    \node [sum] (sum2) at (6,0) {$+$};

                    \draw[->] (x) -- (sum1) -- (sum2) -- (y);
                    \draw[->] (2,0) -- (delay1) -| (sum1);
                    \draw[->] (8,0) -- (delay2) -| (sum2);
                    \fill[black] (7,-1.75) -- (7,-2.25) -- (6.5,-2) -- cycle  node[above left] {\small $\tfrac{1}{2} $};
            \end{tikzpicture}
        \end{center}
	\item \db{Calcule la salida cuando la entrada es $x[n]=u[n]-u[n-2]$. Represéntela hasta $n=4$.}

        \begin{center}
            \begin{tikzpicture}
                \begin{axis}[
                    xmin= -1, xmax= 6,
                    ymin= -0.1, ymax = 1.1,
                    xlabel={$n$}, ylabel={$x[n]$},
                    axis lines = middle,
                    xlabel style={at={(axis cs:6,0)}, anchor=west},
                    ylabel style={at={(axis cs:0,1.1)}, anchor=south},
                ]
                    \pgfmathsetmacro{\mysamples}{6-(-1)+1}
                    \addplot+[ycomb, mark=*, lightblue, line width=1.5, domain=-1:6, samples=\mysamples] {u(x)-u(x-2)};
                \end{axis}
            \end{tikzpicture}
        \end{center}

        $\begin{array}{l}
            n=0\longrightarrow y[0]=\dfrac{1}{2}y[-1]+x[0]+x[-1]=1\\
            n=1\longrightarrow y[1]=\dfrac{1}{2}y[0]+x[1]+x[0]=\dfrac{1}{2}\cdot 1+1+1=\dfrac{5}{2}\\
            n=2\longrightarrow y[2]=\dfrac{1}{2}y[1]+x[2]+x[1]=\dfrac{1}{2}\cdot \dfrac{5}{2}+0+1=\dfrac{9}{4}\\
            n=3\longrightarrow y[3]=\dfrac{1}{2}y[2]+x[3]+x[2]=\dfrac{9}{8}\\
            n=4\longrightarrow y[4]=\dfrac{1}{2}y[3]+x[4]+x[3]=\dfrac{9}{16}
        \end{array}$

        \begin{center}
            \begin{tikzpicture}
                \begin{axis}[
                    xmin= -1, xmax= 4.5,
                    ymin= -0.1, ymax = 3,
                    xlabel={$n$}, ylabel={$h[n]$},
                    axis lines = middle,
                    xlabel style={at={(axis cs:4.5,0)}, anchor=west},
                    ylabel style={at={(axis cs:0,3)}, anchor=south},
                ]
                \addplot+[ycomb, mark=*, lightblue, line width=1.5] coordinates { 
                        (-1,0)
                        (0,1) 
                        (1,5/2) 
                        (2,9/4)
                        (3,9/8)
                        (4,9/16)
                    };
                \end{axis}
            \end{tikzpicture}
        \end{center}
\end{enumerate}

\rc{\textbf{\underline{Problema 2} } }\lb{Dominio de la frecuencia.}
\begin{enumerate}[label=\color{red}\textbf{\alph*)}]
	\item \db{Obtenga \underline{de 2 formas distintas} la expresión analítica del espectro $X(\omega)$ correspondiente a la señal $x(t)=\prod\left( \dfrac{t-\frac{3}{2} }{3}  \right) -\prod\left( \dfrac{t-\frac{9}{2} }{3}  \right) $.}

\begin{enumerate}[label=\bfseries Forma \arabic*:]
    \item \textbf{Usando propiedades de la Transformada de Fourier}

        \begin{enumerate}[label=Paso \arabic*:]
            \item Transformada de la función rectángular básica

                La función rectangular: \[
                \prod\left( \dfrac{t}{T} \right) 
                \] 
                tiene una Transformada de Fourier conocida: \[
                \mathcal{F}\left\{ \prod\left( \dfrac{t}{T} \right)  \right\} =T\cdot \text{sinc}\left( \dfrac{\omega T}{2} \right) 
                \] donde  \[
                \text{sinc}(x)=\dfrac{\sin(x)}{x}.
                \] 
            \item Cambios en la señal original

                Cada función en  $x(t)$ es una versión  \textbf{escalada y desplazada} de la rectangular básica: 
                \[
                x(t)=\prod\left( \dfrac{t-\frac{3}{2} }{3} \right) - \prod\left( \dfrac{t-\frac{9}{2} }{3} \right) 
                \] 
                La forma general es: \[
                \prod\left( \dfrac{t-t_0}{T} \right) \implies \mathcal{F}\left\{ \prod\left( \dfrac{t-t_0}{T} \right)  \right\} =T\cdot \text{sinc}\left( \dfrac{\omega T}{2} \right) e^{-j\omega t_0} 
                \] 
            \item Aplicar la propiedad lineal

                Aplicamos la Transformada de Fourier a cada término:
                \begin{itemize}[label=\textbullet]
                    \item Para el primero:
                        \[
                        \mathcal{F}\left\{ \prod\left( \dfrac{t-\frac{3}{2} }{3} \right)  \right\} =3\cdot \text{sinc}\left( \dfrac{3\omega}{2} \right) e^{-j\omega\cdot \frac{3}{2} } 
                        \] 
                    \item Para el segundo:
                        \[
                       \mathcal{F}\left\{ \prod\left( \dfrac{t-\frac{9}{2} }{3} \right)  \right\} =3\cdot \text{sinc}\left( \dfrac{3\omega}{2} \right) e^{-j\omega\cdot \frac{9}{2} }  
                        \] 
                \end{itemize}
        \end{enumerate}
        \textbf{Resultado (Forma 1):} \[
        X(\omega)=3\cdot \text{sinc} \left( \dfrac{3\omega}{2} \right) \left( e^{-j\omega\cdot \frac{3}{2} } -e^{-j\omega\cdot \frac{9}{2} }  \right) 
        \]
    \item \textbf{Diferencia de funciones rectangulares como combinación de deltas en frecuencia}

        Podemos escribir la señal como la resta de dos funciones idénticas, desplazadas: \[
        x(t)=f\left( t-\dfrac{3}{2} \right) -f\left( t-\dfrac{9}{2}) \right) \text{ con }f(t)=\prod\left( \dfrac{t}{3} \right) 
        \] 
        Entonces su espectro es: \[
        X(\omega)=\mathcal{F}\left\{ f\left( t-\dfrac{3}{2} \right) \right\}  -\mathcal{F}\left\{ f\left( t- \dfrac{9}{2} \right)  \right\} =e^{-j\omega\cdot \frac{3}{2} } F(\omega)-e^{-j\omega\cdot \frac{9}{2} } F(\omega)=F(\omega)\left[ e^{-j\frac{3}{2} \omega}-e^{-j\frac{9}{2} \omega}   \right] 
        \] 
        Con $F(\omega)=3\cdot \text{sinc}\left( \dfrac{3\omega}{2} \right) $, tenemos: \[
        X(\omega)=3\cdot \text{sinc}\left( \dfrac{3\omega}{2} \right) \left[ e^{-j\frac{3}{2} \omega}-e^{-j\frac{9}{2} \omega}   \right] 
        \] 
\end{enumerate}
	\item \db{Considere ahora la señal $z(t)=\sum_{n=-\infty}^{\infty}x(t-6n) $. Represente detalladamente la señal $z(t)$, indique si es periódica y, en caso afirmativo, exprese la señal  $z(t)$ como una combinación lineal de exponenciales complejas. Obtenga la salida  $y(t)$ que resultaría de procesar la señal  $z(t)$ con el sistema LTI caracterizado por la respuesta al impulso  $h(t)=e^{-2t}u(t) $.}

        Se nos da: \[
        z(t)=\sum_{n=-\infty}^{\infty} x(t-6n)
        \] 
        Donde: \[
        x(t)=\prod\left( \dfrac{t-\frac{3}{2} }{3} \right) -\prod\left( \dfrac{t-\frac{9}{2} }{3} \right) 
        \] 
        Esto representa una \textbf{replicación periódica} de $x(t)$ cada 6 unidades de tiempo. En otras palabras, $z(t)$ es la  \textbf{versión periódica} de $x(t)$ con periodo $T=6$.

         \underline{Representación en el tiempo:}

         Recordemos la forma de $x(t)$:
          \begin{itemize}[label=\textbullet]
             \item $x(t)$ es la  \textbf{resto de dos funciones rectangulares} de anchura 3 y de centros en $t=\dfrac{3}{2}$ y $\dfrac{t}{9}$.
             \item Es decir:
                 \begin{itemize}[label=\textbullet]
                     \item La primera parte está entre $[0,3]$
                     \item La segunda está entre  $[3,6]$
                     \item En resumen:  \[
                     x(t)=\begin{cases}
                         1 & t\in [0,3)\\
                         -1 & t\in [3,6)\\
                         0 & \text{en otro caso}
                     \end{cases}
                     \] 
                 \end{itemize}
         \end{itemize}
         Entonces, al hacer la suma periódica: \[
         z(t)=x(t)-x(t-6)+x(t-12)+\cdots
         \] 
         Esta señal repite el mismo patrón:
         \begin{itemize}[label=\textbullet]
             \item \textbf{Pulso de +1} entre $[0+6n,3+6n)$ 
             \item \textbf{Pulso de -1} entre $[3+6n,6+6n)$ 
         \end{itemize}
         \underline{Representación con exponenciales complejas}

         Como $z(t)$ es  \textbf{periódica de periodo} $T=6$, podemos expresarla como una serie de Fourier:  \[
         z(t)=\sum_{k=-\infty}^{\infty} c_ke^{jk\omega_0t}\text{ con }\omega_0=\dfrac{2\pi}{T}=\dfrac{\pi}{3} 
         \]
         Los coeficientes de Fourier se calculan como: \[
         c_k=\dfrac{1}{T}\int_{0}^{T} z(t)e^{-jk\omega_0t}\dt  
         \] 
         Pero en $x(t)$ se tiene un patrón definido en cada periodo:
          \begin{itemize}[label=\textbullet]
              \item Entre $t\in [0,3)$, valor = 1.
              \item Entre $t\in [3,6)$, valor = -1.
         \end{itemize}
         Entonces: \[
         c_k=\dfrac{1}{6}\left( \int_{0}^{3} e^{-jk\frac{\pi}{3} t}\dt-\int_{3}^{6} e^{-jk\frac{\pi}{3} t} \dt\right) 
         \] 
         Calculamos: \[
         \begin{array}{c}
             \int_{0}^{3} e^{-jk\frac{\pi}{3} } \dt=\left[ \dfrac{e^{-jk\frac{\pi}{3} t} }{-jk\frac{\pi}{3} } \right]_0^3=\dfrac{1}{-jk\frac{\pi}{3} }(e^{-jk\pi}-1 )\\
             \int_{3}^{6} e^{-jk\frac{\pi}{3} } \dt=\left[ \dfrac{e^{-jk\frac{\pi}{3} t} }{-jk\frac{\pi}{3} } \right]_3^6=\dfrac{1}{-jk\frac{\pi}{3} }(e^{-jk2\pi}-e^{-jk\pi}  )\\
         \end{array}
         \] 
         Entonces:
         \[
         c_k=\dfrac{1}{6}\cdot\left( \dfrac{e^{-jk\pi}-1 }{-jk\frac{\pi}{3} }-\dfrac{e^{-jk 2\pi}-e^{-jk\pi}  }{-jk\frac{\pi}{3} } \right) =\dfrac{1}{6}\cdot \dfrac{(e^{-jk\pi}-1 )-(e^{-jk 2\pi}-e^{-jk\pi} )}{-jk\frac{\pi}{3}}=\dfrac{1}{6}\cdot \dfrac{2e^{-jk\pi}-e^{-jk 2\pi}-1 }{-jk\frac{\pi}{3}}
         \] 
         Esa es la expresión general de los coeficientes $c_k$, por tanto, la señal es:  \[
         z(t)=\dfrac{1}{6}\cdot \sum_{k=-\infty}^{\infty} \dfrac{2e^{-jk\pi}-e^{-jk 2\pi}-1 }{-jk\frac{\pi}{3}}e^{jk\frac{\pi}{3} t} 
         \] 
         \underline{Salida del sistema LTI con $h(t)=e^{-2t}u(t) $} 

         Este sistema LTI es una convolución: \[
         y(t)=z(t)\ast h(t)
         \] 
         En el dominio de Fourier:
         \begin{itemize}[label=\textbullet]
             \item Si $z(t)=\sum c_ke^{jk\omega_0t} $,
             \item Y el sistema tiene respuesta al impulso $h(t)\implies H(\omega)=\dfrac{1}{jw+2}$ 
         \end{itemize}
         Entonces, al pasar $z(t)$ por el sistema, cada exponencial complejas se multiplica por el valor de  $H(\omega)$ evaluado en $\omega_k=k\omega_0$: \[
         y(t)=\sum_{k=-\infty}^{\infty} c_k\cdot H(k\omega_0)\cdot e^{jk\omega_0t}=\dfrac{1}{6}\cdot \sum_{k=-\infty}^{\infty} \dfrac{2e^{-jk\pi}-e^{-jk 2\pi}-1 }{-jk\frac{\pi}{3}}\cdot \dfrac{1}{2+jk\frac{\pi}{3} } \cdot e^{jk\frac{\pi}{3} t}
         \] 
	\item \db{Se nuestra ahora la señal $x(t)$ del apartado a) tomando una muestra cada  $T_s=0.5$ seg. Escriba la expresión analítica de la secuencia  $x[n]$ resultante, e indique si se habrá producido solapamiento espectral (\textit{aliasing} ) al muestrear.}
	\item \db{Se desea filtrar los 300 primeros valores (esto es, para los índices $0\le n\le 299$) de la secuencia $x[n]$ del apartado anterior con un sistema causal cuya respuesta al impulso  $h[n]$ está comprendida entre los índices  $0\le n\le 199$. Indique \underline{de la forma más eficiente} de obtener el resultado de dicho procesado, $y[n]$, especificando el número de puntos sobre el que se realizarán los cálculos.}
\end{enumerate}
\end{document}

